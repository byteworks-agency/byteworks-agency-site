---
import '../styles/global.css';

interface Props {
  title?: string;
  description?: string;
  image?: string;
  lang?: 'en' | 'es';
}

const {
  title = 'Admin Panel',
  description = 'Private admin area',
  image = '/og-image.png',
  lang = 'en',
} = Astro.props as Props;

const pathname = Astro.url.pathname || '/admin';
const isActive = (href: string) => pathname === href || pathname.startsWith(href + '/');
---

<html lang={lang}>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title}</title>
    <meta name="description" content={description} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={image} />
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
  </head>
  <body class="bg-background-light dark:bg-background-dark font-display text-gray-900 dark:text-text-secondary">
    <header class="flex items-center justify-between whitespace-nowrap border-b border-slate-200 dark:border-slate-700 px-6 lg:px-10 py-3 bg-white dark:bg-background-dark">
      <div class="flex items-center gap-3 text-slate-900 dark:text-white">
        <img src="/logo.png" alt="Logo" width="28" height="28" class="block" />
        <h2 class="text-lg font-bold">Dashboard</h2>
      </div>
      <nav class="hidden md:flex items-center gap-6">
        <a class={`text-sm ${isActive('/admin') ? 'text-primary font-bold' : 'text-slate-600 dark:text-slate-300'}`} href="/admin">Dashboard</a>
        <a class={`text-sm ${isActive('/admin/billing/invoices') ? 'text-primary font-bold' : 'text-slate-600 dark:text-slate-300'}`} href="/admin/billing/invoices">Invoices</a>
        <a class={`text-sm ${isActive('/admin/quotes') ? 'text-primary font-bold' : 'text-slate-600 dark:text-slate-300'}`} href="/admin/quotes">Quotes</a>
      </nav>
      <div class="flex items-center gap-2">
        <a href="/admin/enquiries" class="flex min-w-[84px] items-center justify-center rounded-lg h-10 px-4 bg-primary text-white text-sm font-bold">
          New Request
        </a>
        <button onclick="logout()" class="flex min-w-[84px] items-center justify-center rounded-lg h-10 px-4 border text-sm font-bold">Logout</button>
      </div>
    </header>
    <main class="px-6 lg:px-10 py-8">
      <slot />
    </main>
    <script is:inline>
      async function logout(){
        try { await fetch('/api/auth/logout', { method: 'POST' }); location.replace('/auth/signin'); } catch {}
      }
    </script>
  </body>
  
</html>
