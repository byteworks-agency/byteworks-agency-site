---
interface Props { lang: 'en' | 'es' }
const { lang = 'en' } = Astro.props;

const links = lang === 'es'
  ? [
      { href: '/es/', label: 'Inicio' },
      { href: '/es/about', label: 'Sobre nosotros' },
      { href: '/es/contact', label: 'Contacto' },
    ]
  : [
      { href: '/en/', label: 'Home' },
      { href: '/en/about', label: 'About' },
      { href: '/en/contact', label: 'Contact' },
    ];
---

<header class="sticky top-0 z-50 w-full bg-white/80 dark:bg-neutral-950/80 backdrop-blur-md border-b border-neutral-200 dark:border-neutral-800">
  <div class="max-w-6xl mx-auto px-4 h-16 flex items-center justify-between">
    <a href={`/${lang}/`} class="flex items-center gap-2">
      <picture>
        <source srcset="/logo-dark.png" media="(prefers-color-scheme: dark)" />
        <img src="/logo-light.png" alt="ByteWorks" class="h-7 w-auto" loading="eager" decoding="sync" />
      </picture>
      <span class="text-base sm:text-lg font-semibold font-display tracking-tight">ByteWorks</span>
    </a>

    <nav class="hidden md:flex items-center gap-6 text-sm">
      {links.map((l) => (
        <a href={l.href} class="hover:text-brand transition-colors">{l.label}</a>
      ))}

      <a
        href={lang === 'es' ? '/?lang=en' : '/?lang=es'}
        class="px-2 py-1 border border-neutral-300 dark:border-neutral-700 rounded-md"
        aria-label={lang === 'es' ? 'Cambiar a inglés' : 'Switch to Spanish'}
      >
        {lang === 'es' ? 'EN' : 'ES'}
      </a>
    </nav>

    <button
      id="menu-btn"
      class="md:hidden p-2 rounded-md border border-neutral-300 dark:border-neutral-700"
      aria-label={lang === 'es' ? 'Abrir menú' : 'Open menu'}
      aria-expanded="false"
      aria-controls="mobile-menu"
    >
      <img src="/icons/hamburger.svg" alt="" class="w-5 h-5 dark:invert" />
    </button>
  </div>

  <!-- Menú móvil -->
  <div id="mobile-menu" class="hidden md:hidden border-t border-neutral-200 dark:border-neutral-800 bg-white/95 dark:bg-neutral-950/95">
    <div class="max-w-6xl mx-auto px-4 py-4 flex flex-col gap-3 text-sm">
      <div class="flex items-center justify-between">
        <span class="font-medium">{lang === 'es' ? 'Menú' : 'Menu'}</span>
        <button
          id="menu-close"
          class="p-2 rounded-md border border-neutral-300 dark:border-neutral-700"
          aria-label={lang === 'es' ? 'Cerrar menú' : 'Close menu'}
        >
          <img src="/icons/close.svg" alt="" class="w-5 h-5 dark:invert" />
        </button>
      </div>

      {links.map((l) => (
        <a href={l.href} class="py-2 border-b border-neutral-200/70 dark:border-neutral-800 hover:text-brand">{l.label}</a>
      ))}

      <a
        href={lang === 'es' ? '/?lang=en' : '/?lang=es'}
        class="inline-block px-3 py-2 rounded-md border border-neutral-300 dark:border-neutral-700"
        aria-label={lang === 'es' ? 'Cambiar a inglés' : 'Switch to Spanish'}
      >
        {lang === 'es' ? 'EN' : 'ES'}
      </a>
    </div>
  </div>
</header>

<script is:inline>
  const btn = document.getElementById('menu-btn');
  const closeBtn = document.getElementById('menu-close');
  const panel = document.getElementById('mobile-menu');

  function open() { panel?.classList.remove('hidden'); btn?.setAttribute('aria-expanded', 'true'); }
  function close(){ panel?.classList.add('hidden');    btn?.setAttribute('aria-expanded', 'false'); }

  btn?.addEventListener('click', () => btn.getAttribute('aria-expanded') === 'true' ? close() : open());
  closeBtn?.addEventListener('click', close);
  panel?.querySelectorAll('a').forEach(a => a.addEventListener('click', close));
</script>