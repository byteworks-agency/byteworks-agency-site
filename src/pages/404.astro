---
import Base from '../layouts/Base.astro';
const ENV = import.meta.env;

const pathname = Astro.url.pathname || '/';
const isES = pathname.startsWith('/es');
const lang = isES ? 'es' : 'en';

const title = isES ? 'Página no encontrada — ByteWorks.' : 'Page not found — ByteWorks';
const description = isES
  ? 'La página que buscas no existe o fue movida. Encuentra lo que necesitas en estas secciones.'
  : "The page you are looking for doesn't exist or was moved. Try these helpful links.";

// Links por idioma
const base = isES ? '/es' : '/en';
const home = `${base}/`;
const plans = isES ? `${base}/planes` : `${base}/plans`;
const contact = isES ? `${base}/contacto` : `${base}/contact`;

// WhatsApp opcional (server env)
const phone = ENV.PUBLIC_WHATSAPP_PHONE || '';
const wa = phone ? `https://wa.me/${phone}` : null;

// Alternar idioma manteniendo path equivalente
function altHref(targetLang: 'en' | 'es') {
  const parts = pathname.split('/').filter(Boolean);
  if (parts.length === 0) return `/${targetLang}/`;
  if (parts[0] === 'en' || parts[0] === 'es') {
    parts[0] = targetLang;
  } else {
    parts.unshift(targetLang);
  }
  return `/${parts.join('/')}/`;
}
---

<Base
  title={title}
  description={description}
  image="/og-image.png"
  lang={lang as 'en' | 'es'}
  robots="noindex, nofollow"
>
  <section class="px-6 md:px-10 lg:px-16 max-w-3xl mx-auto py-20 md:py-28 text-center space-y-8">
    <div class="space-y-3">
      <h1 class="text-4xl md:text-6xl font-semibold">404</h1>
      <p class="text-base md:text-lg text-gray-600 dark:text-gray-300">
        {
          isES
            ? 'La página que buscas no existe o fue movida.'
            : "The page you're looking for doesn't exist or was moved."
        }
      </p>
    </div>

    <div class="flex flex-wrap items-center justify-center gap-3">
      <a
        href={home}
        class="inline-flex items-center justify-center px-5 py-3 rounded-md bg-black text-white dark:bg-white dark:text-black hover:opacity-90 transition"
      >
        {isES ? 'Ir al inicio' : 'Go Home'}
      </a>
      <a
        href={plans}
        class="inline-flex items-center justify-center px-5 py-3 rounded-md border border-gray-300 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-800 transition"
      >
        {isES ? 'Ver Planes' : 'See Plans'}
      </a>
      <a
        href={contact}
        class="inline-flex items-center justify-center px-5 py-3 rounded-md border border-gray-300 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-800 transition"
      >
        {isES ? 'Contacto' : 'Contact'}
      </a>
      {
        wa && (
          <a
            href={wa}
            target="_blank"
            rel="noopener noreferrer"
            class="inline-flex items-center justify-center px-5 py-3 rounded-md border border-gray-300 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-800 transition"
          >
            {isES ? 'WhatsApp' : 'WhatsApp'}
          </a>
        )
      }
    </div>

    <div class="pt-6 text-sm text-gray-600 dark:text-gray-400">
      <a href={altHref(isES ? 'en' : 'es')} class="underline">
        {isES ? 'Ver esta página en EN' : 'View this page in ES'}
      </a>
    </div>
  </section>
</Base>
